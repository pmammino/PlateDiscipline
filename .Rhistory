{
fit <- gam(swing ~ s(plate_x,plate_z), family=binomial, data=all_splits[[x]])
all_splits[[x]]$predict <- exp(predict(fit,all_splits[[x]]))/(1 + exp(predict(fit,all_splits[[x]])))
all_predict <- rbind(all_predict,all_splits[[x]])
}
}
#fit <- gam(swing ~ s(plate_x,plate_z), family=binomial, data=all_splits[[1]])
# find predicted probabilities over a 50 x 50 grid
# plate_x <- seq(-1.5, 1.5, length.out=100)
# plate_z <- seq(1.4, 3.75, length.out=100)
# data.predict <- data.frame(plate_x = c(outer(plate_x, plate_z * 0 + 1)),
#                            plate_z = c(outer(plate_x * 0 + 1, plate_z)))
# lp <- predict(fit, data.predict)
# data.predict$Probability <- exp(lp) / (1 + exp(lp))
#
# ggplot(kZone, aes(x, y)) +
#   geom_tile(data=data.predict,
#             aes(x=plate_x, y=plate_z, fill= Probability)) +
#   scale_fill_distiller(palette = "Spectral") +
#   geom_path(lwd=1.5, col="black") +
#   coord_fixed()+labs(title="Swing Rates")
#
# all_splits[[1]]$predict <- exp(predict(fit,all_splits[[1]]))/(1 + exp(predict(fit,all_splits[[1]])))
#
# all_predict <- rbind(all_predict,all_splits[[1]])
x <- predict_swing(30)
all_data <- lapply(1:length(all_splits), predict_swing)
all_data <- do.call("rbind", all_data)
in_zone <- all_data %>% filter(zone == 1 | zone == 2 | zone == 3 | zone == 4 | zone == 5 | zone == 6 | zone == 7 | zone == 8 |zone == 9)
out_of_zone <- all_data %>% filter(zone == 10 | zone == 11 | zone == 12 | zone == 13)
model_zone <- lmer(swing ~ predict + (1|pitcher) + (1|batter),
data = in_zone)
model_out_of_zone <- lmer(swing ~ predict + (1|pitcher) + (1|batter),
data = out_of_zone)
ranef(model_out_of_zone)
summary(model_out_of_zone)
summary(model_in_zone)
summary(model_zone)
in_zone_rates <- in_zone %>% group_by(player_name, pitcher) %>%
arrange(player_name, pitcher) %>%
summarise(Swing_Rate = mean(swing),
zSwing_rate = mean(predict))
View(in_zone_rates)
in_zone_rates$diff <- in_zone_rates$Swing_Rate - in_zone_rates$zSwing_rate
View(in_zone_rates)
in_zone_rates <- in_zone %>% group_by(player_name, pitcher) %>%
arrange(player_name, pitcher) %>%
summarise(Pitches = n(),
Swing_Rate = mean(swing),
xSwing_rate = mean(predict)) %>%
filter(Pitches >= 100)
in_zone_rates$diff <- in_zone_rates$Swing_Rate - in_zone_rates$zSwing_rate
in_zone_rates <- in_zone %>% group_by(player_name, pitcher) %>%
arrange(player_name, pitcher) %>%
summarise(Pitches = n(),
Swing_Rate = mean(swing),
xSwing_rate = mean(predict)) %>%
filter(Pitches >= 100)
in_zone_rates$diff <- in_zone_rates$Swing_Rate - in_zone_rates$xSwing_rate
out_of_zone_pitchers <- ranef(model_out_of_zone)$pitcher
View(out_of_zone_pitchers)
out_of_zone_rates <- out_of_zone %>% group_by(player_name, pitcher) %>%
arrange(player_name, pitcher) %>%
summarise(Pitches = n(),
Swing_Rate = mean(swing),
xSwing_rate = mean(predict)) %>%
filter(Pitches >= 100)
out_of_zone_rates$diff <- out_of_zone_rates$Swing_Rate - out_of_zone_rates$xSwing_rate
View(out_of_zone_pitchers)
View(out_of_zone_rates)
install.packages("devtools")
install.packages("tidyverse")
install.packages("ggplot2")
install.packages("mgcv")
install.packages("REdaS")
install.packages("gridExtra")
install.packages("lme4")
install.packages('reshape')
library(reshape)
library(devtools)
library(tidyverse)
install_github("BillPetti/baseballr")
library(baseballr)
library(ggplot2)
library(mgcv)
library(REdaS)
library(gridExtra)
library(lme4)
options(scipen = 999)
memory.limit(100000)
all_pitches_trim <- readRDS("all_pitches_trim.rds")
all_data <- readRDS("all_data.rds")
setwd("~/")
all_pitches_trim <- readRDS("all_pitches_trim.rds")
all_data <- readRDS("all_data.rds")
setwd("~/GitHub/plate_discipline")
all_pitches_trim <- readRDS("all_pitches_trim.rds")
all_data <- readRDS("all_data.rds")
summarise(all_pitches_trim$description)
unique(all_pitches_trim$description)
all_pitches_trim <- mutate(all_pitches_trim, called_strike=ifelse(description %in% c("called_strike"),1, 0))
called_strikes <- all_pitches_trim %>%
group_by(pitcher, player_name) %>%
arrange(pitcher, player_name) %>%
summarise(CS.Rate = round(mean(called_strike),3))
View(called_strikes)
called_strikes <- all_pitches_trim %>%
group_by(pitcher, player_name) %>%
arrange(pitcher, player_name) %>%
summarise(Pitches = n(),
CS.Rate = round(mean(called_strike),3))
View(all_pitches_trim)
called_strikes_season <- all_pitches_trim %>%
group_by(pitcher, player_name, Season) %>%
arrange(pitcher, player_name,Season) %>%
summarise(Pitches = n(),
CS.Rate = round(mean(called_strike),3))
View(called_strikes_season)
called_strikes_season <- all_pitches_trim %>%
group_by(pitcher, player_name, Season) %>%
arrange(pitcher, player_name,Season) %>%
summarise(Pitches = n(),
CS = sum(called_strike)
CS.Rate = round(mean(called_strike),3))
called_strikes_season <- all_pitches_trim %>%
group_by(pitcher, player_name, Season) %>%
arrange(pitcher, player_name,Season) %>%
summarise(Pitches = n(),
CS = sum(called_strike),
CS.Rate = round(mean(called_strike),3))
setwd("~/GitHub/PlateDiscipline")
install.packages("devtools")
install.packages("tidyverse")
install.packages("ggplot2")
install.packages("mgcv")
install.packages("REdaS")
install.packages("gridExtra")
install.packages("lme4")
install.packages('reshape')
library(reshape)
library(devtools)
library(tidyverse)
install_github("BillPetti/baseballr")
install.packages("devtools")
install.packages("tidyverse")
install.packages("ggplot2")
install.packages("mgcv")
install.packages("REdaS")
install.packages("gridExtra")
install.packages("lme4")
install.packages('reshape')
library(reshape)
library(devtools)
library(tidyverse)
install_github("BillPetti/baseballr")
CS.Rate = round(mean(called_strike),3))
install_github("BillPetti/baseballr")
library(baseballr)
library(ggplot2)
library(mgcv)
library(REdaS)
library(gridExtra)
library(lme4)
options(scipen = 999)
memory.limit(100000)
all_pitches_trim <- readRDS("all_pitches_trim.rds")
all_data <- readRDS("all_data.rds")
in_zone <- all_data %>% filter(zone == 1 | zone == 2 | zone == 3 | zone == 4 | zone == 5 | zone == 6 | zone == 7 | zone == 8 |zone == 9)
out_of_zone <- all_data %>% filter(zone == 10 | zone == 11 | zone == 12 | zone == 13)
model_zone <- lmer(swing ~ predict + (1|pitcher) + (1|batter),
data = in_zone)
model_out_of_zone <- lmer(swing ~ predict + (1|pitcher) + (1|batter),
data = out_of_zone)
out_of_zone_pitchers <- data.frame(ranef(model_out_of_zone)$pitcher)
colnames(out_of_zone_pitchers) <- "OOZ"
in_zone_pitchers <- data.frame(ranef(model_zone)$pitcher)
colnames(in_zone_pitchers) <- "IZ"
all_results <- merge(in_zone_pitchers,out_of_zone_pitchers,by = "row.names")
colnames(all_results) <- c("pitcher","IZ","OOZ")
all_results$pitcher <- as.numeric(all_results$pitcher)
in_zone_data <- in_zone %>%
group_by(pitcher, player_name) %>%
arrange(pitcher, player_name) %>%
summarise(IZ.Pitches = n(),
IZ.Swing = round(mean(swing),5),
IZ.xSwing = round(mean(predict),5)) %>%
filter(IZ.Pitches >= 500)
out_of_zone_data <- out_of_zone %>%
group_by(pitcher, player_name) %>%
arrange(pitcher, player_name) %>%
summarise(OOZ.Pitches = n(),
OOZ.Swing = round(mean(swing),5),
OOZ.xSwing = round(mean(predict),5)) %>%
filter(OOZ.Pitches >= 300)
whiff_predict_data <- readRDS("whiff_predict_data.rds")
model_whiff <- lmer(whiff ~ predict_whiff + (1|pitcher) + (1|batter),
data = whiff_predict_data)
whiff_pitchers <- data.frame(ranef(model_whiff)$pitcher)
colnames(whiff_pitchers) <- "In_Whiff"
whiff_data <- whiff_predict_data %>%
group_by(pitcher, player_name) %>%
arrange(pitcher, player_name) %>%
summarise(Pitches = n(),
Whiff = round(mean(whiff),5),
xWhiff = round(mean(predict_whiff),5)) %>%
filter(Pitches >= 500)
whiff_data <- merge(whiff_data,whiff_pitchers, by.x = "pitcher", by.y = "row.names")
plate_discipline <- merge(whiff_data,out_of_zone_data,by = "pitcher")
plate_discipline <- merge(plate_discipline,in_zone_data,by = "pitcher")
plate_discipline <- merge(plate_discipline,all_results,by = "pitcher")
plate_discipline <- plate_discipline[,c("pitcher",
"player_name",
"Pitches",
"Whiff",
"xWhiff",
"In_Whiff",
"OOZ.Pitches",
"OOZ.Swing",
"OOZ.xSwing",
"OOZ",
"IZ.Pitches",
"IZ.Swing",
"IZ.xSwing",
"IZ")]
plate_discipline$Score <- plate_discipline$OOZ - plate_discipline$IZ + plate_discipline$In_Whiff
write.csv(plate_discipline, "plate_discipline.csv")
whiff_predict_data_2019 <- whiff_predict_data %>%
filter(Season == 2019)
model_whiff_2019 <- lmer(whiff ~ predict_whiff + (1|pitcher) + (1|batter),
data = whiff_predict_data_2019)
whiff_pitchers_2019 <- data.frame(ranef(model_whiff_2019)$pitcher)
colnames(whiff_pitchers_2019) <- "In_Whiff"
whiff_data_2019 <- whiff_predict_data_2019 %>%
group_by(pitcher, player_name, Season) %>%
arrange(pitcher, player_name,Season) %>%
summarise(Pitches = n(),
Whiff = round(mean(whiff),5),
xWhiff = round(mean(predict_whiff),5)) %>%
filter(Pitches >= 500)
whiff_data_2019 <- merge(whiff_data_2019,whiff_pitchers_2019, by.x = "pitcher", by.y = "row.names")
###2018 Whiff ----
whiff_predict_data_2018 <- whiff_predict_data %>%
filter(Season == 2018)
model_whiff_2018 <- lmer(whiff ~ predict_whiff + (1|pitcher) + (1|batter),
data = whiff_predict_data_2018)
whiff_pitchers_2018 <- data.frame(ranef(model_whiff_2018)$pitcher)
colnames(whiff_pitchers_2018) <- "In_Whiff"
whiff_data_2018 <- whiff_predict_data_2018 %>%
group_by(pitcher, player_name, Season) %>%
arrange(pitcher, player_name,Season) %>%
summarise(Pitches = n(),
Whiff = round(mean(whiff),5),
xWhiff = round(mean(predict_whiff),5)) %>%
filter(Pitches >= 500)
whiff_data_2018 <- merge(whiff_data_2018,whiff_pitchers_2018, by.x = "pitcher", by.y = "row.names")
###2017 Whiff ----
whiff_predict_data_2017 <- whiff_predict_data %>%
filter(Season == 2017)
model_whiff_2017 <- lmer(whiff ~ predict_whiff + (1|pitcher) + (1|batter),
data = whiff_predict_data_2017)
whiff_pitchers_2017 <- data.frame(ranef(model_whiff_2017)$pitcher)
colnames(whiff_pitchers_2017) <- "In_Whiff"
whiff_data_2017 <- whiff_predict_data_2017 %>%
group_by(pitcher, player_name, Season) %>%
arrange(pitcher, player_name,Season) %>%
summarise(Pitches = n(),
Whiff = round(mean(whiff),5),
xWhiff = round(mean(predict_whiff),5)) %>%
filter(Pitches >= 500)
whiff_data_2017 <- merge(whiff_data_2017,whiff_pitchers_2017, by.x = "pitcher", by.y = "row.names")
###2016 Whiff ----
whiff_predict_data_2016 <- whiff_predict_data %>%
filter(Season == 2016)
model_whiff_2016 <- lmer(whiff ~ predict_whiff + (1|pitcher) + (1|batter),
data = whiff_predict_data_2016)
whiff_pitchers_2016 <- data.frame(ranef(model_whiff_2016)$pitcher)
colnames(whiff_pitchers_2016) <- "In_Whiff"
whiff_data_2016 <- whiff_predict_data_2016 %>%
group_by(pitcher, player_name, Season) %>%
arrange(pitcher, player_name,Season) %>%
summarise(Pitches = n(),
Whiff = round(mean(whiff),5),
xWhiff = round(mean(predict_whiff),5)) %>%
filter(Pitches >= 500)
whiff_data_2016 <- merge(whiff_data_2016,whiff_pitchers_2016, by.x = "pitcher", by.y = "row.names")
###2015 Whiff ----
whiff_predict_data_2015 <- whiff_predict_data %>%
filter(Season == 2015)
model_whiff_2015 <- lmer(whiff ~ predict_whiff + (1|pitcher) + (1|batter),
data = whiff_predict_data_2015)
whiff_pitchers_2015 <- data.frame(ranef(model_whiff_2015)$pitcher)
colnames(whiff_pitchers_2015) <- "In_Whiff"
whiff_data_2015 <- whiff_predict_data_2015 %>%
group_by(pitcher, player_name, Season) %>%
arrange(pitcher, player_name,Season) %>%
summarise(Pitches = n(),
Whiff = round(mean(whiff),5),
xWhiff = round(mean(predict_whiff),5)) %>%
filter(Pitches >= 500)
whiff_data_2015 <- merge(whiff_data_2015,whiff_pitchers_2015, by.x = "pitcher", by.y = "row.names")
#Season Whiffs----
all_whiff_seasons <- rbind(whiff_data_2019,whiff_data_2018,whiff_data_2017,whiff_data_2016,whiff_data_2015)
all_data_2019 <- all_data %>% filter(Season == 2019)
in_zone_2019 <- all_data_2019 %>% filter(zone == 1 | zone == 2 | zone == 3 | zone == 4 | zone == 5 | zone == 6 | zone == 7 | zone == 8 |zone == 9)
out_of_zone_2019 <- all_data_2019 %>% filter(zone == 10 | zone == 11 | zone == 12 | zone == 13)
model_zone_2019 <- lmer(swing ~ predict + (1|pitcher) + (1|batter),
data = in_zone_2019)
model_out_of_zone_2019 <- lmer(swing ~ predict + (1|pitcher) + (1|batter),
data = out_of_zone_2019)
out_of_zone_pitchers_2019 <- data.frame(ranef(model_out_of_zone_2019)$pitcher)
colnames(out_of_zone_pitchers_2019) <- "OOZ"
in_zone_pitchers_2019 <- data.frame(ranef(model_zone_2019)$pitcher)
colnames(in_zone_pitchers_2019) <- "IZ"
all_results_2019 <- merge(in_zone_pitchers_2019,out_of_zone_pitchers_2019,by = "row.names")
colnames(all_results_2019) <- c("pitcher","IZ","OOZ")
all_results_2019$pitcher <- as.numeric(all_results_2019$pitcher)
all_results_2019$Season <- 2019
in_zone_data_2019 <- in_zone_2019 %>%
group_by(pitcher, player_name) %>%
arrange(pitcher, player_name) %>%
summarise(IZ.Pitches = n(),
IZ.Swing = round(mean(swing),5),
IZ.xSwing = round(mean(predict),5)) %>%
filter(IZ.Pitches >= 500)
in_zone_data_2019$Season <- 2019
out_of_zone_data_2019 <- out_of_zone_2019 %>%
group_by(pitcher, player_name) %>%
arrange(pitcher, player_name) %>%
summarise(OOZ.Pitches = n(),
OOZ.Swing = round(mean(swing),5),
OOZ.xSwing = round(mean(predict),5)) %>%
filter(OOZ.Pitches >= 300)
out_of_zone_data_2019$Season <- 2019
all_data_2018 <- all_data %>% filter(Season == 2018)
in_zone_2018 <- all_data_2018 %>% filter(zone == 1 | zone == 2 | zone == 3 | zone == 4 | zone == 5 | zone == 6 | zone == 7 | zone == 8 |zone == 9)
out_of_zone_2018 <- all_data_2018 %>% filter(zone == 10 | zone == 11 | zone == 12 | zone == 13)
model_zone_2018 <- lmer(swing ~ predict + (1|pitcher) + (1|batter),
data = in_zone_2018)
model_out_of_zone_2018 <- lmer(swing ~ predict + (1|pitcher) + (1|batter),
data = out_of_zone_2018)
out_of_zone_pitchers_2018 <- data.frame(ranef(model_out_of_zone_2018)$pitcher)
colnames(out_of_zone_pitchers_2018) <- "OOZ"
in_zone_pitchers_2018 <- data.frame(ranef(model_zone_2018)$pitcher)
colnames(in_zone_pitchers_2018) <- "IZ"
all_results_2018 <- merge(in_zone_pitchers_2018,out_of_zone_pitchers_2018,by = "row.names")
colnames(all_results_2018) <- c("pitcher","IZ","OOZ")
all_results_2018$pitcher <- as.numeric(all_results_2018$pitcher)
all_results_2018$Season <- 2018
in_zone_data_2018 <- in_zone_2018 %>%
group_by(pitcher, player_name) %>%
arrange(pitcher, player_name) %>%
summarise(IZ.Pitches = n(),
IZ.Swing = round(mean(swing),5),
IZ.xSwing = round(mean(predict),5)) %>%
filter(IZ.Pitches >= 500)
in_zone_data_2018$Season <- 2018
out_of_zone_data_2018 <- out_of_zone_2018 %>%
group_by(pitcher, player_name) %>%
arrange(pitcher, player_name) %>%
summarise(OOZ.Pitches = n(),
OOZ.Swing = round(mean(swing),5),
OOZ.xSwing = round(mean(predict),5)) %>%
filter(OOZ.Pitches >= 300)
out_of_zone_data_2018$Season <- 2018
all_data_2017 <- all_data %>% filter(Season == 2017)
in_zone_2017 <- all_data_2017 %>% filter(zone == 1 | zone == 2 | zone == 3 | zone == 4 | zone == 5 | zone == 6 | zone == 7 | zone == 8 |zone == 9)
out_of_zone_2017 <- all_data_2017 %>% filter(zone == 10 | zone == 11 | zone == 12 | zone == 13)
model_zone_2017 <- lmer(swing ~ predict + (1|pitcher) + (1|batter),
data = in_zone_2017)
model_out_of_zone_2017 <- lmer(swing ~ predict + (1|pitcher) + (1|batter),
data = out_of_zone_2017)
out_of_zone_pitchers_2017 <- data.frame(ranef(model_out_of_zone_2017)$pitcher)
colnames(out_of_zone_pitchers_2017) <- "OOZ"
in_zone_pitchers_2017 <- data.frame(ranef(model_zone_2017)$pitcher)
colnames(in_zone_pitchers_2017) <- "IZ"
all_results_2017 <- merge(in_zone_pitchers_2017,out_of_zone_pitchers_2017,by = "row.names")
colnames(all_results_2017) <- c("pitcher","IZ","OOZ")
all_results_2017$pitcher <- as.numeric(all_results_2017$pitcher)
all_results_2017$Season <- 2017
in_zone_data_2017 <- in_zone_2017 %>%
group_by(pitcher, player_name) %>%
arrange(pitcher, player_name) %>%
summarise(IZ.Pitches = n(),
IZ.Swing = round(mean(swing),5),
IZ.xSwing = round(mean(predict),5)) %>%
filter(IZ.Pitches >= 500)
in_zone_data_2017$Season <- 2017
out_of_zone_data_2017 <- out_of_zone_2017 %>%
group_by(pitcher, player_name) %>%
arrange(pitcher, player_name) %>%
summarise(OOZ.Pitches = n(),
OOZ.Swing = round(mean(swing),5),
OOZ.xSwing = round(mean(predict),5)) %>%
filter(OOZ.Pitches >= 300)
out_of_zone_data_2017$Season <- 2017
all_data_2016 <- all_data %>% filter(Season == 2016)
in_zone_2016 <- all_data_2016 %>% filter(zone == 1 | zone == 2 | zone == 3 | zone == 4 | zone == 5 | zone == 6 | zone == 7 | zone == 8 |zone == 9)
out_of_zone_2016 <- all_data_2016 %>% filter(zone == 10 | zone == 11 | zone == 12 | zone == 13)
model_zone_2016 <- lmer(swing ~ predict + (1|pitcher) + (1|batter),
data = in_zone_2016)
model_out_of_zone_2016 <- lmer(swing ~ predict + (1|pitcher) + (1|batter),
data = out_of_zone_2016)
out_of_zone_pitchers_2016 <- data.frame(ranef(model_out_of_zone_2016)$pitcher)
colnames(out_of_zone_pitchers_2016) <- "OOZ"
in_zone_pitchers_2016 <- data.frame(ranef(model_zone_2016)$pitcher)
colnames(in_zone_pitchers_2016) <- "IZ"
all_results_2016 <- merge(in_zone_pitchers_2016,out_of_zone_pitchers_2016,by = "row.names")
colnames(all_results_2016) <- c("pitcher","IZ","OOZ")
all_results_2016$pitcher <- as.numeric(all_results_2016$pitcher)
all_results_2016$Season <- 2016
in_zone_data_2016 <- in_zone_2016 %>%
group_by(pitcher, player_name) %>%
arrange(pitcher, player_name) %>%
summarise(IZ.Pitches = n(),
IZ.Swing = round(mean(swing),5),
IZ.xSwing = round(mean(predict),5)) %>%
filter(IZ.Pitches >= 500)
in_zone_data_2016$Season <- 2016
out_of_zone_data_2016 <- out_of_zone_2016 %>%
group_by(pitcher, player_name) %>%
arrange(pitcher, player_name) %>%
summarise(OOZ.Pitches = n(),
OOZ.Swing = round(mean(swing),5),
OOZ.xSwing = round(mean(predict),5)) %>%
filter(OOZ.Pitches >= 300)
out_of_zone_data_2016$Season <- 2016
all_data_2015 <- all_data %>% filter(Season == 2015)
in_zone_2015 <- all_data_2015 %>% filter(zone == 1 | zone == 2 | zone == 3 | zone == 4 | zone == 5 | zone == 6 | zone == 7 | zone == 8 |zone == 9)
out_of_zone_2015 <- all_data_2015 %>% filter(zone == 10 | zone == 11 | zone == 12 | zone == 13)
model_zone_2015 <- lmer(swing ~ predict + (1|pitcher) + (1|batter),
data = in_zone_2015)
model_out_of_zone_2015 <- lmer(swing ~ predict + (1|pitcher) + (1|batter),
data = out_of_zone_2015)
out_of_zone_pitchers_2015 <- data.frame(ranef(model_out_of_zone_2015)$pitcher)
colnames(out_of_zone_pitchers_2015) <- "OOZ"
in_zone_pitchers_2015 <- data.frame(ranef(model_zone_2015)$pitcher)
colnames(in_zone_pitchers_2015) <- "IZ"
all_results_2015 <- merge(in_zone_pitchers_2015,out_of_zone_pitchers_2015,by = "row.names")
colnames(all_results_2015) <- c("pitcher","IZ","OOZ")
all_results_2015$pitcher <- as.numeric(all_results_2015$pitcher)
all_results_2015$Season <- 2015
in_zone_data_2015 <- in_zone_2015 %>%
group_by(pitcher, player_name) %>%
arrange(pitcher, player_name) %>%
summarise(IZ.Pitches = n(),
IZ.Swing = round(mean(swing),5),
IZ.xSwing = round(mean(predict),5)) %>%
filter(IZ.Pitches >= 500)
in_zone_data_2015$Season <- 2015
out_of_zone_data_2015 <- out_of_zone_2015 %>%
group_by(pitcher, player_name) %>%
arrange(pitcher, player_name) %>%
summarise(OOZ.Pitches = n(),
OOZ.Swing = round(mean(swing),5),
OOZ.xSwing = round(mean(predict),5)) %>%
filter(OOZ.Pitches >= 300)
out_of_zone_data_2015$Season <- 2015
out_of_zone_data_all <- rbind(out_of_zone_data_2015,out_of_zone_data_2016,out_of_zone_data_2017,out_of_zone_data_2018,out_of_zone_data_2019)
in_zone_data_all <- rbind(in_zone_data_2015,in_zone_data_2016,in_zone_data_2017,in_zone_data_2018,in_zone_data_2019)
all_results_all <- rbind(all_results_2015,all_results_2016,all_results_2017,all_results_2018,all_results_2019)
plate_discipline_all <- merge(all_whiff_seasons,out_of_zone_data_all,by = c("pitcher","Season"))
plate_discipline_all <- merge(plate_discipline_all,in_zone_data_all,by = c("pitcher","Season"))
plate_discipline_all <- merge(plate_discipline_all,all_results_all,by = c("pitcher","Season"))
plate_discipline_all <- plate_discipline_all[,c("pitcher",
"player_name",
"Season",
"Pitches",
"Whiff",
"xWhiff",
"In_Whiff",
"OOZ.Pitches",
"OOZ.Swing",
"OOZ.xSwing",
"OOZ",
"IZ.Pitches",
"IZ.Swing",
"IZ.xSwing",
"IZ")]
plate_discipline_all$Score <- plate_discipline_all$OOZ - plate_discipline_all$IZ + plate_discipline_all$In_Whiff
whiff_league <- mean(whiff_predict_data$predict_whiff)
ooz_league <- all_data %>%
filter(zone == 10 | zone == 11 | zone == 12 | zone == 13) %>%
mean(predict)
all_data %>%
filter(zone == 10 | zone == 11 | zone == 12 | zone == 13)
all_data %>%
filter(zone == 10 | zone == 11 | zone == 12 | zone == 13) %>%
mean(predict)
test <-  all_data %>%
filter(zone == 10 | zone == 11 | zone == 12 | zone == 13)
mean(test$predict)
ooz_all <- all_data %>%
filter(zone == 10 | zone == 11 | zone == 12 | zone == 13)
ooz_league <- mean(ooz_all$predict)
iz_all <- all_data %>%
filter(zone == 1 | zone == 2 | zone == 3 | zone == 4 | zone == 5 | zone == 6 | zone == 7 | zone == 8 |zone == 9)
iz_league <- mean(iz_all$predict)
plate_discipline_all$command <- round((plate_discipline_all$xWhiff/whiff_league) +
(plate_discipline_all$OOZ.xSwing/ooz_league) +
(1-((iz_league-plate_discipline_all$IZ.xSwing)/iz_league)),3)
View(plate_discipline_all)
plate_discipline_all$command <- round((plate_discipline_all$xWhiff/whiff_league) +
(plate_discipline_all$OOZ.xSwing/ooz_league) +
(1-((iz_league+plate_discipline_all$IZ.xSwing)/iz_league)),3)
plate_discipline_all$command <- round((plate_discipline_all$xWhiff/whiff_league) +
(plate_discipline_all$OOZ.xSwing/ooz_league) +
(1+((iz_league-plate_discipline_all$IZ.xSwing)/iz_league)),3)
write.csv(plate_discipline_all,"plate_discipline_all.csv")
View(plate_discipline_all)
mean(plate_discipline_all$command
)
plate_discipline_all$Score <- round(plate_discipline_all$OOZ - plate_discipline_all$IZ + plate_discipline_all$In_Whiff,3)
